<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team1.careercanvas.mapper.UserMapper">

    <select id="idCheck" resultType="Integer">
        select count(userid)
        from user
        where userid = #{param1};
    </select>

    <select id="namecheck" resultType="Integer">
        select count(username)
        from user
        where username = #{param1};
    </select>

    <select id="emailcheck" resultType="Integer">
        select count(useremail)
        from user
        where useremail = #{param1};
    </select>

    <insert id="signupPersonal">
        insert into user(userid, userpwd, username, useremail, usertel, usertype, usersalt)
        values (#{param1}, #{param2}, #{param3}, #{param4}, #{param5}, #{param6}, #{param7});
    </insert>

    <insert id="signupBiz">
        insert into company(user_userid, companyno)
        values (#{param1}, #{param2});
    </insert>

    <update id="InsertAuthImg">
        update company
        set authimg = #{param1}
        where companyno = #{param2}
    </update>


    <select id="getUser" resultType="com.team1.careercanvas.vo.UserVO">
        select userpwd, usersalt, usertype,username, profileimg
        from user
        where userid = #{param1};
    </select>

    <select id="getBizNo" resultType="String">
        select companyno
        from company
        where user_userid = #{param1};
    </select>

    <select id="getAccept" resultType="Integer">
        select isaccept
        from company
        where user_userid = #{param1};
    </select>

    <select id="getUserId" resultType="String">
        select userid
        from user
        where useremail = #{param1} and usertype = #{param2};
    </select>

    <select id="getUserIdForBiz" resultType="String">
        select user.userid
        from user
                 join company on user.userid = company.user_userid
        where company.companyno = #{param2}
          and user.useremail = #{param1}
        and user.usertype = #{param3}
    </select>

    <select id="getUserPwd" resultType="String">
        select userpwd
        from user
        where userid = #{param1} and useremail = #{param2} and usertype = #{param3};
    </select>

    <select id="getUserPwdForBiz" resultType="String">
        select user.userpwd
        from user
                 join company on user.userid = company.user_userid
        where company.companyno = #{param4}
          and user.useremail = #{param2}
          and user.usertype = #{param3}
        and user.userid=#{param1}
    </select>

    <select id="getUserIdByPwd" resultType="String">
        select userid from user where userpwd = #{param1};
    </select>

    <update id="deleteUserPwd">
        update user set usersalt='dontbreakmysalt' where userid = #{param1};
    </update>

    <update id="changePwd">
        update user set usersalt = #{param3}, userpwd = #{param2} where userid=#{param1};
    </update>
    
    <!-- 권혁준 작업  -->
	<select id="getUserInfo" resultType="com.team1.careercanvas.vo.UserVO">
		select userid, userpwd, username, useremail, usertel, comment , profileimg
		from user
		where userid=#{param1};
	</select>
	
	<update id="updateMypageWithoutPwd"> 
		update user set username=#{param1}, usertel=#{param2}, comment=#{param3}
		where userid=#{param4};
	</update>

    <select id="getSendMsg" resultType="com.team1.careercanvas.vo.MessageVO">
        select * 
        from message
        where user_userid = #{param1};
    </select>

    <select id="getReceiveMsg" resultType="com.team1.careercanvas.vo.MessageVO">
        select * 
        from message
        where user_userid1 = #{param1};
    </select>
	
	<!-- 김효준작업 -->


    <select id="getSubmitSubjectSolo" resultType="com.team1.careercanvas.vo.SubmitSubjectVO">
        select a.applyid as applyid, s.subjecttitle as subjecttitle, a.applyimg as applyimg
        from subjectapply a
        left join subject s on a.subject_subjectid = s.subjectid
        where a.user_userid = #{param1}
        </if>
        
    </select>

    <select id="getSubmitSubjectTeam" resultType="com.team1.careercanvas.vo.SubmitSubjectVO">
        select a.applyid as applyid, s.subjecttitle as subjecttitle, a.applyimg as applyimg
        from subjectapply a
        left join subject s on a.subject_subjectid = s.subjectid
        where a.user_userid = #{param1}
    </select>
	
</mapper>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team1.careercanvas.mapper.BoardMapper">
    <insert id="InsertNewPost">
        insert into post (posttitle, postcontent, boardcategory, category, hashtag, user_userid)
        VALUES (#{posttitle}, #{postcontent}, #{boardcategory}, #{category}, #{hashtag}, #{user_userid})
    </insert>

<!--  정인식 작업 ( 글 내용 보기 )  -->
    <select id="SelectBoardView" resultType="com.team1.careercanvas.vo.BoardVO">
        select * from post where postid=#{param1}
    </select>
    <update id="ViewsCount">
        update post set views=post.views+1 where postid=${param1}
    </update>

    <insert id="LikeCount">
        insert into postlike(user_userid, post_postid)
        VALUES (#{param2}, #{param1})
    </insert>

    <select id="getPost" resultType="com.team1.careercanvas.vo.BoardVO">
        select * from post
                 where boardcategory=#{boardcategory}
        <where>
            <if test="searchKey == 'all'">
                AND (posttitle=#{searchWord} OR user_userid=#{searchWord} or postcontent=#{searchWord})
            </if>
            <if test="searchKey == 'title'">
                AND posttitle=#{searchWord}
            </if>
            <if test="searchKey == 'author'">
                AND user_userid=#{searchWord}
            </if>
            <if test="searchKey == 'content'">
                AND postcontent=#{searchWord}
            </if>
        </where>

    </select>

    <select id="getPostWithCat" resultType="com.team1.careercanvas.vo.BoardVO">
        select * from post where boardcategory=#{boardcategory}
        and category=#{category}
        <where>
            <if test="searchKey == 'all'">
                AND (posttitle=#{searchWord} OR user_userid=#{searchWord} or postcontent=#{searchWord})
            </if>
            <if test="searchKey == 'title'">
                AND posttitle=#{searchWord}
            </if>
            <if test="searchKey == 'author'">
                AND user_userid=#{searchWord}
            </if>
            <if test="searchKey == 'content'">
                AND postcontent=#{searchWord}
            </if>
        </where>
    </select>

    <!-- 권혁준 작업 -->
    <select id="getmyPost" resultType="com.team1.careercanvas.vo.BoardVO">
        select * 
        from post
        where user_userid = #{param1};
    </select>

    <select id="getmyComment" resultType="com.team1.careercanvas.vo.CommentVO">
        select * 
        from comment
        where user_userid = #{param1};
    </select>

    <select id="CheckValid" resultType="Integer">
        select count(user_userid) from postlike where user_userid=#{param2} and post_postid=#{param1}
    </select>

    <select id="GetLikeAmount" resultType="Integer">
        select count(user_userid) from postlike where post_postid=#{param1}
    </select>
</mapper>